-- Main GUI Script for GitHub

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local ScrollingFrame = Instance.new("ScrollingFrame")
local WallHackButton = Instance.new("TextButton")
local AimButton = Instance.new("TextButton")
local InfJumpButton = Instance.new("TextButton")
local NameDistanceButton = Instance.new("TextButton")
local NoClipButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local ToggleButton = Instance.new("TextButton") -- Button to open/close the GUI
local UICornerMainFrame = Instance.new("UICorner")
local UICornerButtons = Instance.new("UICorner")
local UICornerCloseButton = Instance.new("UICorner")

-- GUI Properties
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set background to black
MainFrame.Size = UDim2.new(0, 300, 0, 500)
MainFrame.Position = UDim2.new(0.1, 0, 0.1, 0)
MainFrame.Visible = false -- Start with the GUI hidden

-- Add UICorner to MainFrame
UICornerMainFrame.CornerRadius = UDim.new(0, 12)
UICornerMainFrame.Parent = MainFrame

ScrollingFrame.Parent = MainFrame
ScrollingFrame.Size = UDim2.new(1, 0, 1, -50)
ScrollingFrame.Position = UDim2.new(0, 0, 0, 50)
ScrollingFrame.CanvasSize = UDim2.new(0, 0, 4, 0)
ScrollingFrame.ScrollBarThickness = 10

-- Helper function to apply rainbow effect to buttons
local function rainbowEffect(button)
    spawn(function()
        while true do
            for hue = 0, 1, 0.01 do
                button.BackgroundColor3 = Color3.fromHSV(hue, 1, 1)
                wait(0.1)
            end
        end
    end)
end

-- Draggable GUI function
local dragging
local dragInput
local dragStart
local startPos

local function makeDraggable(frame)
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    frame.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            if dragging then
                local delta = input.Position - dragStart
                frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end
    end)
end

-- Initialize GUI
makeDraggable(MainFrame) -- Make the main frame draggable

-- Wall Hack Button
WallHackButton.Parent = ScrollingFrame
WallHackButton.Text = "Wall Hacks"
WallHackButton.Size = UDim2.new(0, 250, 0, 50)
WallHackButton.Position = UDim2.new(0, 25, 0, 10)
WallHackButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set button color to black
WallHackButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text

-- Add UICorner to WallHackButton
local UICornerWallHack = UICornerButtons:Clone()
UICornerWallHack.Parent = WallHackButton

rainbowEffect(WallHackButton)

local wallHackEnabled = false
WallHackButton.MouseButton1Click:Connect(function()
    wallHackEnabled = not wallHackEnabled
    if wallHackEnabled then
        -- Wall hack code (local only, see players through walls)
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer and player.Character then
                for _, part in pairs(player.Character:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.Transparency = 0.5
                        part.BrickColor = BrickColor.new("Bright red")
                        part.CanCollide = false
                    end
                end
            end
        end
        
        -- Modify shooting logic to ignore walls
        local function onWeaponFired(weapon, direction)
            local origin = weapon.Position
            local target = origin + (direction.Unit * 1000) -- Extend the ray far
            local ray = Ray.new(origin, target - origin)
            local hitPart, hitPos = game.Workspace:FindPartOnRay(ray, game.Players.LocalPlayer)

            -- If we hit a player
            if hitPart and hitPart:IsDescendantOf(game.Players) then
                -- Logic to handle shooting
                print("Hit player:", hitPart.Parent.Name)
            end
        end

        -- Connect to a weapon firing event (adjust based on how your game handles shooting)
        local player = game.Players.LocalPlayer
        player.CharacterAdded:Wait() -- Ensure the character is loaded
        local character = player.Character
        local tool = character:FindFirstChildOfClass("Tool") -- Adjust based on your tool setup
        
        if tool then
            tool.Activated:Connect(function()
                onWeaponFired(tool.Handle, (tool.Handle.Position - character.HumanoidRootPart.Position).Unit)
            end)
        end
        
    else
        -- Reset transparency and color
        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= game.Players.LocalPlayer and player.Character then
                for _, part in pairs(player.Character:GetChildren()) do
                    if part:IsA("BasePart") then
                        part.Transparency = 0
                        part.BrickColor = BrickColor.new("Medium stone grey")
                        part.CanCollide = true
                    end
                end
            end
        end
    end
end)

-- Aim Button
AimButton.Parent = ScrollingFrame
AimButton.Text = "Aim Lock"
AimButton.Size = UDim2.new(0, 250, 0, 50)
AimButton.Position = UDim2.new(0, 25, 0, 70)
AimButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set button color to black
AimButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text

-- Add UICorner to AimButton
local UICornerAim = UICornerButtons:Clone()
UICornerAim.Parent = AimButton

rainbowEffect(AimButton)

local aimLockEnabled = false
local targetPlayer = nil -- Store the first locked target
AimButton.MouseButton1Click:Connect(function()
    aimLockEnabled = not aimLockEnabled
    if aimLockEnabled then
        -- Aim lock code (local only, locks onto the first player)
        local camera = game.Workspace.CurrentCamera
        local localPlayer = game.Players.LocalPlayer

        for _, player in pairs(game.Players:GetPlayers()) do
            if player ~= localPlayer and player.Character and not targetPlayer then
                local head = player.Character:FindFirstChild("Head")
                if head then
                    targetPlayer = head
                    break
                end
            end
        end

        game:GetService("RunService").RenderStepped:Connect(function()
            if aimLockEnabled and targetPlayer then
                camera.CFrame = CFrame.new(camera.CFrame.Position, targetPlayer.Position)
            end
        end)
    else
        targetPlayer = nil -- Reset the target when aimlock is turned off
    end
end)

-- Infinite Jump Button
InfJumpButton.Parent = ScrollingFrame
InfJumpButton.Text = "Infinite Jump"
InfJumpButton.Size = UDim2.new(0, 250, 0, 50)
InfJumpButton.Position = UDim2.new(0, 25, 0, 130)
InfJumpButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set button color to black
InfJumpButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text

-- Add UICorner to InfJumpButton
local UICornerInfJump = UICornerButtons:Clone()
UICornerInfJump.Parent = InfJumpButton

rainbowEffect(InfJumpButton)

local infJumpEnabled = false
InfJumpButton.MouseButton1Click:Connect(function()
    infJumpEnabled = not infJumpEnabled
    if infJumpEnabled then
        -- Infinite jump code (local only)
        local localPlayer = game.Players.LocalPlayer
        game:GetService("UserInputService").JumpRequest:Connect(function()
            if infJumpEnabled then
                localPlayer.Character:FindFirstChildOfClass('Humanoid'):ChangeState("Jumping")
            end
        end)
    end
end)

-- Name & Distance Button
NameDistanceButton.Parent = ScrollingFrame
NameDistanceButton.Text = "Show Names & Distances"
NameDistanceButton.Size = UDim2.new(0, 250, 0, 50)
NameDistanceButton.Position = UDim2.new(0, 25, 0, 190)
NameDistanceButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set button color to black
NameDistanceButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text

-- Add UICorner to NameDistanceButton
local UICornerNameDistance = UICornerButtons:Clone()
UICornerNameDistance.Parent = NameDistanceButton

rainbowEffect(NameDistanceButton)

local nameDistanceEnabled = false
NameDistanceButton.MouseButton1Click:Connect(function()
    nameDistanceEnabled = not nameDistanceEnabled
    if nameDistanceEnabled then
        -- Show names and distances above players
        for _, player in pairs(game.Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("Head") then
                local billboard = Instance.new("BillboardGui")
                billboard.Adornee = player.Character.Head
                billboard.Size = UDim2.new(0, 100, 0, 50)
                billboard.StudsOffset = Vector3.new(0, 3, 0)

                local nameLabel = Instance.new("TextLabel")
                nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
                nameLabel.BackgroundTransparency = 1
                nameLabel.Text = player.Name
                nameLabel.TextColor3 = Color3.new(1, 1, 1)
                nameLabel.Parent = billboard

                local distanceLabel = Instance.new("TextLabel")
                distanceLabel.Size = UDim2.new(1, 0, 0.5, 0)
                distanceLabel.Position = UDim2.new(0, 0, 0.5, 0)
                distanceLabel.BackgroundTransparency = 1
                distanceLabel.TextColor3 = Color3.new(1, 1, 1)
                distanceLabel.Parent = billboard

                billboard.Parent = player.Character.Head

                -- Update distance in real-time
                game:GetService("RunService").RenderStepped:Connect(function()
                    if nameDistanceEnabled and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        local distance = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).Magnitude
                        distanceLabel.Text = tostring(math.floor(distance)) .. " Studs"
                    end
                end)
            end
        end
    else
        -- Remove all Billboards when deactivated
        for _, player in pairs(game.Players:GetPlayers()) do
            if player.Character and player.Character:FindFirstChild("Head") then
                for _, child in pairs(player.Character.Head:GetChildren()) do
                    if child:IsA("BillboardGui") then
                        child:Destroy()
                    end
                end
            end
        end
    end
end)

-- NoClip Button
NoClipButton.Parent = ScrollingFrame
NoClipButton.Text = "NoClip"
NoClipButton.Size = UDim2.new(0, 250, 0, 50)
NoClipButton.Position = UDim2.new(0, 25, 0, 250)
NoClipButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set button color to black
NoClipButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text

-- Add UICorner to NoClipButton
local UICornerNoClip = UICornerButtons:Clone()
UICornerNoClip.Parent = NoClipButton

rainbowEffect(NoClipButton)

local noClipEnabled = false
NoClipButton.MouseButton1Click:Connect(function()
    noClipEnabled = not noClipEnabled
    local player = game.Players.LocalPlayer
    local character = player.Character
    if noClipEnabled then
        -- Enable NoClip (allows player to walk through walls)
        game:GetService("RunService").Stepped:Connect(function()
            if noClipEnabled and character then
                for _, part in pairs(character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
    else
        -- Disable NoClip (restore collisions)
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end)

-- Toggle Button
ToggleButton.Parent = ScreenGui
ToggleButton.Text = "O" -- Open the GUI
ToggleButton.Size = UDim2.new(0, 50, 0, 50)
ToggleButton.Position = UDim2.new(0, 10, 0.5, -25) -- Centered vertically on the left
ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0) -- Set background color to black
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text for visibility

-- Add UICorner to ToggleButton
local UICornerToggleButton = Instance.new("UICorner")
UICornerToggleButton.CornerRadius = UDim.new(0, 12)
UICornerToggleButton.Parent = ToggleButton

ToggleButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = not MainFrame.Visible
    ToggleButton.Text = MainFrame.Visible and "C" or "O" -- Change text based on visibility
end)

-- Close Button
CloseButton.Parent = MainFrame
CloseButton.Text = "X"
CloseButton.Size = UDim2.new(0, 50, 0, 50)
CloseButton.Position = UDim2.new(1, -55, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Red color for close button

-- Add UICorner to CloseButton
UICornerCloseButton.CornerRadius = UDim.new(0, 12)
UICornerCloseButton.Parent = CloseButton

-- Close button functionality
CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    ToggleButton.Text = "O" -- Reset toggle button to 'Open' state
end)

-- Ensure all buttons are aligned and the GUI is clean
for i, button in pairs(ScrollingFrame:GetChildren()) do
    if button:IsA("TextButton") then
        button.Size = UDim2.new(0, 250, 0, 50)
        button.Position = UDim2.new(0, 25, 0, button.Position.Y.Offset)
        button.BackgroundTransparency = 0.3
    end
end

-- Keep the GUI persistent
MainFrame.Visible = true
